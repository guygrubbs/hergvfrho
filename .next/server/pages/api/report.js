"use strict";(()=>{var e={};e.id=706,e.ids=[706],e.modules={9993:e=>{e.exports=require("googleapis")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},3306:(e,t,n)=>{n.r(t),n.d(t,{config:()=>P,default:()=>S,routeModule:()=>D});var i={};n.r(i),n.d(i,{default:()=>h});var a=n(1802),o=n(7153),s=n(6249),r=n(9993);let l=require("nodemailer");var m=n.n(l);let d=require("pdfkit");var c=n.n(d),u=n(2048),p=n.n(u),f=n(5315),y=n.n(f);let v=m().createTransport({service:"your_email_service",auth:{user:"your_email",pass:"your_email_password"}}),w=()=>{let e=new r.google.auth.OAuth2("your_client_id","your_client_secret","your_redirect_uri");return e.setCredentials({refresh_token:"your_refresh_token"}),r.google.drive({version:"v3",auth:e})};function A(e){return`
    ${e.companyName} - Investment Opportunity Analysis
    
    Overall Score: ${e.metrics.overallScore}/10
    
    Key Highlights:
    • Market Opportunity: ${e.metrics.marketAnalysis.score}/10
    • Team Capability: ${e.metrics.teamAnalysis.score}/10
    • Product Viability: ${e.metrics.productAnalysis.score}/10
    
    Investment Recommendation: ${e.metrics.investmentRecommendation.recommendation}
    
    Financial Overview:
    • Monthly Burn Rate: $${e.financials.burnAnalysis.monthlyBurn.toLocaleString()}
    • Runway: ${e.financials.burnAnalysis.runwayMonths} months
    • Projected Growth: ${e.financials.revenueAnalysis.projectedGrowth}%
    
    Competitive Position: ${e.competitors.competitiveThreatLevel} threat level
  `.trim()}async function g(e,t){return new Promise((n,i)=>{let a=new(c())({size:"A4",margins:{top:72,left:72,bottom:72,right:72},info:{Title:`Investment Analysis Report - ${e.companyName}`,Author:"Startup Analysis Platform",Subject:"Startup Investment Analysis"}}),o=y().join(process.cwd(),"tmp",`${e.submissionId}_report.pdf`),s=p().createWriteStream(o);a.pipe(s),a.fontSize(24).text("Investment Analysis Report",{align:"center"}).moveDown().fontSize(18).text(e.companyName,{align:"center"}).moveDown().fontSize(12).text(`Generated: ${new Date().toLocaleDateString()}`,{align:"center"}).moveDown(2),a.addPage().fontSize(16).text("Executive Summary",{underline:!0}).moveDown().fontSize(12).text(A(e)).moveDown(2),a.addPage().fontSize(16).text("Company Overview",{underline:!0}).moveDown().fontSize(12).text(`Industry: ${t.companyInfo.industry}`).moveDown().text(`Stage: ${t.companyInfo.stage}`).moveDown().text(`Location: ${t.companyInfo.location}`).moveDown().text(`Founded: ${t.companyInfo.foundedYear}`).moveDown(2),a.addPage().fontSize(16).text("Market Analysis",{underline:!0}).moveDown().fontSize(12).text(e.metrics.marketAnalysis.explanation).moveDown(2),a.fontSize(16).text("Team Analysis",{underline:!0}).moveDown().fontSize(12).text(e.metrics.teamAnalysis.explanation).moveDown(2),a.addPage().fontSize(16).text("Product Analysis",{underline:!0}).moveDown().fontSize(12).text(e.metrics.productAnalysis.explanation).moveDown(2),a.addPage().fontSize(16).text("Financial Analysis",{underline:!0}).moveDown().fontSize(12).text(e.financials.burnAnalysis.analysis).moveDown().text("Revenue Analysis:").text(e.financials.revenueAnalysis.analysis).moveDown().text("Unit Economics:").text(e.financials.unitEconomics.analysis).moveDown(2),a.addPage().fontSize(16).text("Competitive Analysis",{underline:!0}).moveDown().fontSize(12),e.competitors.directCompetitors.forEach(e=>{a.text(`Competitor: ${e.name}`).moveDown().text("Strengths:").list(e.strengths).moveDown().text("Weaknesses:").list(e.weaknesses).moveDown()}),a.addPage().fontSize(16).text("Risk Analysis",{underline:!0}).moveDown().fontSize(12).text("Key Risks:").list(e.metrics.riskAnalysis.risks).moveDown().text("Mitigation Strategies:").list(e.metrics.riskAnalysis.mitigations).moveDown(2),a.addPage().fontSize(16).text("Investment Recommendation",{underline:!0}).moveDown().fontSize(12).text(e.metrics.investmentRecommendation.recommendation).moveDown().text(e.metrics.investmentRecommendation.rationale).moveDown(2),a.end(),s.on("finish",()=>n(o)),s.on("error",i)})}async function x(e,t,n){let i=`
    <h2>Investment Analysis Report - ${n.companyName}</h2>
    <p>Please find attached the detailed investment analysis report for ${n.companyName}.</p>
    
    <h3>Executive Summary</h3>
    <p>${A(n)}</p>
    
    <p>For a detailed analysis, please review the attached PDF report.</p>
    
    <p>Best regards,<br>Startup Analysis Platform</p>
  `;await v.sendMail({from:"your_email",to:e,subject:`Investment Analysis Report - ${n.companyName}`,html:i,attachments:[{filename:`${n.companyName}_Investment_Analysis.pdf`,path:t}]})}async function h(e,t){if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});let{submissionId:n,recipientEmail:i}=e.body;if(!n||!i)return t.status(400).json({error:"Submission ID and recipient email are required"});try{let e=w(),[a,o]=await Promise.all([e.files.list({q:`name contains '${n}_Analysis.json'`,fields:"files(id, name)"}),e.files.list({q:`name contains '${n}_Metadata.json'`,fields:"files(id, name)"})]);if(!a.data.files.length||!o.data.files.length)return t.status(404).json({error:"Analysis or metadata not found"});let[s,r]=await Promise.all([e.files.get({fileId:a.data.files[0].id,alt:"media"}),e.files.get({fileId:o.data.files[0].id,alt:"media"})]),l=s.data,m=r.data,d=await g(l,m),c=await e.files.create({requestBody:{name:`${l.companyName}_Investment_Analysis.pdf`,parents:[m.fileIds.companyFolderId]},media:{mimeType:"application/pdf",body:p().createReadStream(d)}});await x(i,d,l),p().unlinkSync(d),t.status(200).json({success:!0,message:"Report generated and sent successfully",reportId:c.data.id})}catch(e){console.error("Report generation error:",e),t.status(500).json({success:!1,error:"Failed to generate or send report",details:e.message})}}let S=(0,s.l)(i,"default"),P=(0,s.l)(i,"config"),D=new a.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/report",pathname:"/api/report",bundlePath:"",filename:""},userland:i})},7153:(e,t)=>{var n;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,t,n)=>{e.exports=n(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var n=t(t.s=3306);module.exports=n})();